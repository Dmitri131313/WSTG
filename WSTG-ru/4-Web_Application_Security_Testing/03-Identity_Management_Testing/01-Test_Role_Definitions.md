---

layout: col-document
title: WSTG - Latest
tags: WSTG

---

{% include breadcrumb.html %}
# Тестирование определения ролей

|ID          |
|------------|
|WSTG-IDNT-01|

## Обзор

Приложения имеют несколько типов функциональных возможностей и сервисов, и для них требуются права доступа, основанные на потребностях пользователя. Этим пользователем может быть:

- администратор, который управляет функциональными возможностями приложения;
- аудитор, который анализирует транзакции приложения и предоставляет подробный отчет;
- инженер службы сопровождения, который помогает клиентам разобраться в приложении и решает их проблемы с учётными записями;
- клиент, который взаимодействует с приложением и пользуется его услугами.

Чтобы справиться с перечисленными выше и прочими сценариями использования приложения, настраиваются определения ролей (что также известно как [RBAC](https://en.wikipedia.org/wiki/Role-based_access_control)). Имея эти роли, пользователь способен выполнить требуемые задачи.

## Задачи тестирования

- Определить и задокументировать роли, используемые приложением.
- Попытаться переключиться, изменить или получить доступ к другой роли.
- Проанализировать состав ролей и потребности, лежащие в основе предоставленных разрешений.

## Как тестировать

### Идентификация ролей

Тестировщик должен начать с выявления тестируемых ролей в приложении с помощью любого из следующих методов:

- Документация приложения.
- Руководство разработчика или администратора приложения.
- Комментарии к приложению.
- Фаззинг возможных ролей:
    - параметры cookie (*например*, `role=admin`, `isAdmin=True`)
    - параметры учётной записи (*например*, `Role: manager`)
    - скрытые каталоги или файлы (*например*, `/admin`, `/mod`, `/backups`)
    - переключение на распространённые роли (*например*, `admin`, `backups`, и т.д.)

### Переключение на доступные роли

После определения возможных векторов атак тестировщику необходимо протестировать и подтвердить, что у него есть доступ к имеющимся ролям.

> Некоторые приложения определяют роли пользователя при создании с помощью строгих проверок и политик или путём обеспечения надлежащей защиты роли пользователя с помощью электронной подписи, созданной серверной частью. Обнаружение того, что роли существуют, ещё не означает, что они являются уязвимостью.

### Анализ разрешений ролей

Получив доступ к ролям в системе, тестировщик должен понимать, какие разрешения предоставляются каждой роли.

Инженер службы сопровождения не должен иметь возможности выполнять административные функции, управлять резервными копиями или проводить какие-либо транзакции за пользователя.

Администратор не должен обладать абсолютно всеми полномочиями в системе. Чувствительные функции администратора должны использовать принцип второй руки или использовать многофакторную аутентификацию, чтобы гарантировать, что именно администратор проводит транзакцию. Ярким примером этого стал [инцидент с Twitter в 2020 г](https://www.dfs.ny.gov/Twitter_Report).

## Инструменты

Вышеупомянутые тесты можно проводить без использования какого-либо инструмента, кроме того, что используется для доступа к системе.

Чтобы упростить и документировать работу, можно использовать:

- [Burp, расширение Autorize](https://github.com/Quitten/Autorize)
- [ZAP, дополнение для тестирования контроля доступа](https://www.zaproxy.org/docs/desktop/addons/access-control-testing/)

## Ссылки

- [Role Engineering for Enterprise Security Management, E Coyne & J Davis, 2007](https://www.bookdepository.co.uk/Role-Engineering-for-Enterprise-Security-Management-Edward-Coyne/9781596932180)
- [Разработка ролей и стандарты RBAC](https://csrc.nist.gov/projects/role-based-access-control#rbac-standard)
